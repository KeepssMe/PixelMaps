// ==UserScript==
// @name Pixel Minimap
// @description Did I make a minimap? Hope
// @version 0.2.2
// @author KeepssMe. Thank you Sallbet for testing and listening to my whining
// @exclude *git.pixelplanet.fun/*
// @match *.pixelplanet.fun/*
// @match *pixelplanet.fun/*
// @match *fuckyouarkeros.fun/*
// @match *pixelzone.io/*
// @match *pixelcanvas.io/*
// @connect raw.githubusercontent.com
// @downloadURL https://raw.githubusercontent.com/KeepssMe/PixelMaps/master/minimap.user.js
// @grant unsafeWindow
// @grant GM_addStyle
// @grant GM_addElement
// @grant GM_getResourceText
// @grant GM_listValues
// @grant GM_setValue
// @grant GM_getValue
// @grant GM_deleteValue
// @grant GM_registerMenuCommand
// @grant GM_xmlhttpRequest
// @resource PPF_CHUNK_CHEKING https://raw.githubusercontent.com/KeepssMe/PixelMaps/master/ppf_chunkChecking.js
// @resource TRANSLATIONS https://raw.githubusercontent.com/KeepssMe/PixelMaps/master/translations.json
// @resource STYLES https://raw.githubusercontent.com/KeepssMe/PixelMaps/master/styles.css
// @resource VIEWS https://raw.githubusercontent.com/KeepssMe/PixelMaps/master/views.html
// @run-at document-start
// @sandbox raw
// @updateURL https://raw.githubusercontent.com/KeepssMe/PixelMaps/master/minimap.user.js
// ==/UserScript==

(()=>{const t=100,n=200,i=201,r=202,e=203,s=204,o=300,u="100_",a="200";const h=new class{#t=new Map;#n=new Map;t(t,n){const i=this.#t.get(t);i&&i.forEach((t=>t(n)))}i(t,n){let i=this.#t.get(t);return i||(i=[],this.#t.set(t,i)),i.push(n),()=>{const i=this.#t.get(t);1===i.length?this.#t.delete(t):this.#t.set(t,i.filter((t=>t!==n)))}}o(t,n){this.#n.has(t)||this.#n.set(t,n)}u(t){return this.#n.get(t)}h(){this.t(a,null)}};function c(t,n,i){return Math.max(t,Math.min(n,i))}const f=new Error("Incorrect value type");function l(t){switch(typeof t){case"number":case"boolean":case"string":case"bigint":case"undefined":return t;case"object":if(null===t)return null;let n=Array.isArray(t)?[]:{};for(let i in t)t.hasOwnProperty(i)&&(n[i]=l(t[i]));return n;default:throw f}}function p(t,n){if(t===n)return!0;const i=typeof t;if(i!==typeof n)return!1;switch(i){case"number":case"boolean":case"string":case"bigint":case"undefined":return!1;case"object":if(null===t)return!1;let i=Array.isArray(t);if(i!==Array.isArray(n))return!1;if(i){if(t.length!==n.length)return!1;for(let i=0;i<t.length;++i)if(!p(t[i],n[i]))return!1;return!0}let r=Object.keys(t);if(r.length!==Object.keys(n).length)return!1;for(let i of r)if(!p(t[i],n[i]))return!1;return!0;default:throw f}}const d=window[23..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-14-i)})).join("")}(32,123)+21..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-13)})).join("")+1004141..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-54-i)})).join("")}(31,205,195,183,171)+14..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-26-i)})).join("")}(32,173)],g=window[function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-0-i)})).join("")}(43,114)+29..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+21..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-13)})).join("")+590..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-20-i)})).join("")}(3,139)+12..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-13)})).join("")+381..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-15-i)})).join("")}(12,144)+14..toString(36).toLowerCase()],m=window[function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-27-i)})).join("")}(6,138,151,130,111,104)+29..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-0-i)})).join("")}(61,181,171,159,147)+14..toString(36).toLowerCase()],y=window[857..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-2-i)})).join("")}(59,172,164,162,156)+19202..toString(36).toLowerCase()+12..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-13)})).join("")+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-34-i)})).join("")}(22,153)+28310..toString(36).toLowerCase()],v=window[function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-18-i)})).join("")}(33,148,129,122)+21269..toString(36).toLowerCase()+34..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+690366..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-8-i)})).join("")}(14,122,136)+14..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-63-i)})).join("")}(19,204,184,166)+29..toString(36).toLowerCase()],S=window[857..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+21..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-13)})).join("")+10..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-45-i)})).join("")}(38,202,168,184,183)+1245..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-14-i)})).join("")}(22,137)],w=window[function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-35-i)})).join("")}(48,183,180,161,154)+481..toString(36).toLowerCase()+21..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+27742..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-45-i)})).join("")}(41,187)+23..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-52-i)})).join("")}(34,202)],A=window[857..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+21..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-13)})).join("")+35512..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-21-i)})).join("")}(33,179,171,161,136,172,158,172,170,159)+19..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+41366111..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-43-i)})).join("")}(16,159)],b=(window[857..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+21..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-13)})).join("")+30..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-61-i)})).join("")}(11,192,181,178,175,187,182)+38115..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-5-i)})).join("")}(24,131,106)+23..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-3-i)})).join("")}(55,170,171,126,175)+28895..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-61-i)})).join("")}(52,213)],window[23..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-10-i)})).join("")}(3,90)][function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-19-i)})).join("")}(29,158,168)+21..toString(36).toLowerCase()+24..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+29..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-13-i)})).join("")}(22,139,119,148,151)+1252468..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-13-i)})).join("")}(12,141)]),k=async t=>{const n={};n[30..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-28-i)})).join("")}(18,160)+21..toString(36).toLowerCase()]=t.l,t.p&&(n[function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-38-i)})).join("")}(19,171)+690396..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-0-i)})).join("")}(45,161,155)+14..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-35-i)})).join("")}(24,181,143)+914..toString(36).toLowerCase()]=t.p),t.m&&(n[852..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-9-i)})).join("")}(25,132,133)+12..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-48-i)})).join("")}(7,157,159)]=!t.m);let i=await b(n);return{S:i[986..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-38-i)})).join("")}(30,181,181,181,183)+28..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-8-i)})).join("")}(24,133)],A:i[1037..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-37-i)})).join("")}(31,185,165)+1108..toString(36).toLowerCase()]}};class M{static{const t=window.GM.info.script.version;g("version",void 0)!==t&&(d().forEach((t=>y(t))),m("version",t))}#i=new Map;#r;#e=t=>this.#r+t;constructor(t){this.#r=t+"_",h.i(a,(()=>this.#s()))}k(t,n,i){if(this.#i.has(t))return;if(void 0===n&&void 0===i)return;const r=this.#e(t);let e=g(r,void 0);if(void 0===e){const t=void 0===n?i:n;void 0!==t&&(e=t,m(r,t))}let s={M:l(e),C:void 0};this.#i.set(t,s),void 0!==i&&(s.C=l(i))}T(t){if(this.#i.has(t))return l(this.#i.get(t).M);const n=g(this.#e(t),void 0);return this.#i.set(t,{M:n,C:void 0}),l(n)}I(t,n){if(!this.#i.has(t)){const n=g(this.#e(t),void 0);this.#i.set(t,{M:n,C:void 0})}let i=this.#i.get(t);if(p(n,i.M))return;const r=i.M;i.M=l(n),m(this.#e(t),n),this.#o(t,r,i.M)}#s(){for(let[t,n]of this.#i.entries()){if(void 0===n.C||p(n.M,n.C))continue;const i=n.M;n.M=l(n.C),m(this.#e(t),n.M),this.#o(t,i,n.M)}}#o(t,n,i){h.t(u+t,[l(n),l(i)])}K(t,n){return h.i(u+t,(t=>n(t[0],t[1])))}}class C{$;R;constructor(t,n){this.$=t,this.R=n}}const T=(new DOMParser).parseFromString(v(function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-1-i)})).join("")}(26,113)+25..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-11-i)})).join("")}(35,115)+13..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-13)})).join("")+35..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")),"text/html").body.children;function I(t){if(t>T.length)throw new Error(`View with index ${t} not found`);return T.item(t).cloneNode(!0)}function K(t,n,i){return t.querySelectorAll(n).item(i)}class x extends C{_;L;constructor(t,n){super(t,n),this.L=K(this.$,".minimap_tab-menu-buttons",0),this._=[]}O(){const t=function(t,n={},i=null){const r=document.createElement(t);if(n)for(let t of Object.keys(n))r.setAttribute(t,n[t]);return i&&i.insertAdjacentElement("beforeend",r),r}("button",{},this.L);this._.push(t)}}class $ extends C{D;X;constructor(t,n){super(t,n),this.D=K(this.$,".minimap_canvas",0),this.X=K(this.$,".minimap_fast-functions",0)}}class R extends C{U;constructor(t,n){super(t,n),this.U=K(this.$,".minimap_tab-settings-detail",0)}}class _{Y;B;V}class L{W;j;P;N;H;F;q;G;J=new _;constructor(){this.W=I(1),this.j=K(this.W,".minimap_resizers",0),this.P={Z:K(this.j,".minimap_resizer-lt",0),tt:K(this.j,".minimap_resizer-rt",0),nt:K(this.j,".minimap_resizer-lb",0),it:K(this.j,".minimap_resizer-rb",0)},this.N=K(this.W,".minimap_header-menu",0),this.H=K(this.W,".minimap_header-status",0),this.F=K(this.W,".minimap_header-move",0),this.q=K(this.W,".minimap_header-close",0),this.G=K(this.W,".minimap_main",0),this.J.Y=new x(K(this.W,".minimap_tab-menu",0),"menu"),this.J.B=new $(K(this.W,".minimap_tab-main",0),"main"),this.J.Y.O(),this.J.V=new R(K(this.W,".minimap_tab-settings",0),"settings"),this.J.Y.O()}rt(t){S(v(function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-27-i)})).join("")}(54,164)+375..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-13)})).join("")+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-5-i)})).join("")}(24,114,99,105))),t.et.insertAdjacentElement("afterbegin",I(0)),this.W.style.zIndex=t.zIndex,t.et.insertAdjacentElement("beforeend",this.W)}}const O=new Map;let D;function z(){return D}function E(t){return O.get(t)}(()=>{let t=JSON.parse(v(10..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-13)})).join("")+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-40-i)})).join("")}(39,161)+17..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-52-i)})).join("")}(27,147,157,163,157)+10..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-13)})).join("")+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-62-i)})).join("")}(28,163)+1146..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-35-i)})).join("")}(5,123)));if(0==t.length)throw new Error("Could not find a translation");for(let n of t)if(!O.has(n.name)&&(O.set(n.name,(t=>n.translations[t]??t)),!D&&n.langs))for(let t of n.langs)navigator.languages.includes(t)&&(D=n.name);D||(D=t[0].name)})();const X="setting_",U=["dark","darkmini"],Y=200,B=50;class V{st;ot;ut;ht;constructor(t){this.st=t,this.ot=I(3),this.ut=K(this.ot,".minimap_setting-name",0),this.ht=K(this.ot,".minimap_setting-value",0)}ct(){}ft(t){this.ut.textContent=t(`${X}${this.st}`)}}class W extends V{lt;dt=new Map;gt;yt;constructor(t,n,i,r,e){super(t),this.gt=n,this.yt=i,this.lt=document.createElement("select"),this.ht.insertAdjacentElement("beforeend",this.lt);for(let{vt:t,St:n}of e){const i=document.createElement("option");i.value=t,i.textContent=t,this.lt.insertAdjacentElement("beforeend",i),this.dt.set(t,{wt:i,At:n})}this.lt.value=r,this.lt.addEventListener("change",(()=>this.#u()))}ct(){this.lt.value=this.yt,this.#u()}#u(){this.dt.get(this.lt.value).At()}ft(t){if(super.ft(t),this.gt)for(let{wt:n}of this.dt.values())n.textContent=t(`${X}${this.st}_${n.value}`)}}class j{bt;kt;Mt;constructor(t){this.bt=t,this.kt=I(2),this.Mt=K(this.kt,"summary",0)}ft(t){this.Mt.textContent=t(`group_${this.bt}`)}}class P{#a=[];#h=new Map;#c;#f;#l;constructor(){this.#c=h.u(t),this.#f=h.u(n),this.#c.k("lang",void 0,z()),this.Ct({st:"lang",gt:!0,yt:z(),Tt:this.#c.T("lang"),It:[...O.keys()].map((t=>({vt:t,St:()=>this.#c.I("lang",t)})))}),this.#c.K("lang",((t,n)=>this.#p(n))),h.i(a,(()=>this.#h.forEach((t=>t.ct()))))}Ct(t){if(this.#h.has(t.st))return;const n=new W(t.st,t.gt,t.yt,t.Tt,t.It);this.#h.set(n.st,n)}Kt(t){for(let{bt:n,xt:i}of t){const t=new j(n);this.#a.push(t),this.#f.J.V.U.insertAdjacentElement("beforeend",t.kt);for(let n of i){const i=this.#h.get(n);i&&t.kt.insertAdjacentElement("beforeend",i.ot)}}this.#l=A("Reset minimap",(()=>h.h())),this.#p(this.#c.T("lang"))}#p(t){const n=E(t);this.#l=A(n("gm_menu_reset"),(()=>h.h()),{id:this.#l});for(let t of this.#a.values())t.ft(n);for(let t of this.#h.values())t.ft(n)}}class N{#c;W;constructor(){this.#c=h.u(t);const r=h.u(n),e=h.u(i);this.W=r.W,this.#c.k("theme",void 0,U[0]),e.Ct({st:"theme",gt:!1,yt:U[0],Tt:this.#c.T("theme"),It:U.map((t=>({vt:t,St:()=>this.#c.I("theme",t)})))}),this.#c.K("theme",((t,n)=>this.W.setAttribute("theme",n)))}Kt(){this.W.setAttribute("theme",this.#c.T("theme"))}}class H{#c;#f;#d=null;#g=null;#m=null;#y;#v=new Map;constructor(){this.#c=h.u(t),this.#f=h.u(n),this.#y=E(this.#c.T("lang")),this.#c.K("lang",((t,n)=>{this.#y=E(n),this.#p()}));let i=this.#f.J.Y,r=[this.#f.J.B,this.#f.J.V];for(let t=0;t<i._.length;++t)this.#v.set(r[t].R,i._[t]),i._[t].addEventListener("click",(()=>this.#S(r[t])));this.#f.N.addEventListener("click",(()=>{this.#m===this.#f.J.Y?this.#S(this.#g):this.#S(this.#f.J.Y)})),this.#f.q.addEventListener("click",(()=>{this.#S(this.#f.J.B)})),this.#f.W.addEventListener("mouseenter",(()=>{this.#d&&(clearTimeout(this.#d),this.#d=null)})),this.#f.W.addEventListener("mouseleave",(()=>{this.#m!==this.#f.J.B&&(this.#d=setTimeout((()=>this.#S(this.#f.J.B)),5e3))}))}#S(t){t!==this.#m&&(this.#f.q.hidden=t===this.#f.J.B,t.$.hidden=!1,this.#m.$.hidden=!0,this.#f.H.textContent=this.#w(t.R),this.#g=this.#m,this.#m=t)}Kt(){this.#m=this.#f.J.B,this.#y=E(this.#c.T("lang")),this.#p()}#p(){this.#f.H.textContent=this.#w(this.#m.R);for(let[t,n]of this.#v.entries())n.textContent=this.#w(t)}#w=t=>this.#y(`tab_${t}`)}class F{#c;#f;$t;constructor(){this.#c=h.u(t),this.#f=h.u(n);const r=h.u(i);this.#c.k("posIsLeft",void 0,!1),this.#c.k("posIsTop",void 0,!0),this.#c.k("posX",void 0,0),this.#c.k("posY",void 0,0),this.#c.k("posIsMove",void 0,!1),this.#c.k("posWidth",void 0,300),this.#c.k("posHeight",void 0,300),this.#c.k("posIsResize",void 0,!0),r.Ct({st:"fixAngle",gt:!0,yt:"rt",Tt:`${this.#c.T("posIsLeft")?"l":"r"}${this.#c.T("posIsTop")?"t":"b"}`,It:[{vt:"lt",St:()=>{this.#c.I("posIsLeft",!0),this.#c.I("posIsTop",!0)}},{vt:"rt",St:()=>{this.#c.I("posIsLeft",!1),this.#c.I("posIsTop",!0)}},{vt:"lb",St:()=>{this.#c.I("posIsLeft",!0),this.#c.I("posIsTop",!1)}},{vt:"rb",St:()=>{this.#c.I("posIsLeft",!1),this.#c.I("posIsTop",!1)}}]}),r.Ct({st:"lockMove",gt:!0,yt:"y",Tt:this.#c.T("posIsMove")?"n":"y",It:[{vt:"y",St:()=>this.#c.I("posIsMove",!1)},{vt:"n",St:()=>this.#c.I("posIsMove",!0)}]}),r.Ct({st:"lockSize",gt:!0,yt:"n",Tt:this.#c.T("posIsResize")?"n":"y",It:[{vt:"y",St:()=>this.#c.I("posIsResize",!1)},{vt:"n",St:()=>this.#c.I("posIsResize",!0)}]}),this.#c.K("posIsLeft",((t,n)=>{let i=this.$t.getBoundingClientRect(),r=this.#f.W.getBoundingClientRect();this.#c.I("posX",n?r.left-i.left:i.right-r.right)})),this.#c.K("posIsTop",((t,n)=>{let i=this.$t.getBoundingClientRect(),r=this.#f.W.getBoundingClientRect();this.#c.I("posY",n?r.top-i.top:i.bottom-r.bottom)})),this.#c.K("posX",((t,n)=>{this.#c.T("posIsLeft")?(this.#f.W.style.left=n+"px",this.#f.W.style.right=null):(this.#f.W.style.left=null,this.#f.W.style.right=n+"px")})),this.#c.K("posY",((t,n)=>{this.#c.T("posIsTop")?(this.#f.W.style.top=n+"px",this.#f.W.style.bottom=null):(this.#f.W.style.top=null,this.#f.W.style.bottom=n+"px")})),this.#c.K("posIsMove",((t,n)=>this.#f.F.hidden=!n)),this.#c.K("posWidth",((t,n)=>this.#f.W.style.width=`${n}px`)),this.#c.K("posHeight",((t,n)=>this.#f.W.style.height=`${n}px`)),this.#c.K("posIsResize",((t,n)=>this.#f.j.hidden=!n))}#A(t){let n=this.#c.T("posIsLeft"),i=this.#c.T("posIsTop");const r=(()=>{let r=this.$t.getBoundingClientRect(),e=this.#f.W.getBoundingClientRect(),s=r.width-e.width,o=r.height-e.height,u=n?{v:"left",f:t=>t-h}:{v:"right",f:t=>h-t},a=i?{v:"top",f:t=>t-f}:{v:"bottom",f:t=>f-t},h=t.clientX+r[u.v]-e[u.v],f=t.clientY+r[a.v]-e[a.v];return(t,n)=>{this.#f.W.style[u.v]=c(0,u.f(t),s)+"px",this.#f.W.style[a.v]=c(0,a.f(n),o)+"px"}})(),e=t=>r(t.pageX,t.pageY),s=()=>{let t=this.$t.getBoundingClientRect(),r=this.#f.W.getBoundingClientRect();this.#c.I("posX",n?r.left-t.left:t.right-r.right),this.#c.I("posY",i?r.top-t.top:t.bottom-r.bottom),document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",s)};document.addEventListener("mousemove",e),document.addEventListener("mouseup",s)}#b(){const t=this.$t.getBoundingClientRect(),n=(n,i,r,e,s,o)=>{let u=Math.max(Y,t[e]-B),a=u>s?s:u;this.#f.W.style[e]=`${a}px`,this.#f.W.style[o?n:i]=c(0,u-a,r)+"px"};n("left","right",this.#c.T("posX"),"width",this.#c.T("posWidth"),this.#c.T("posIsLeft")),n("top","bottom",this.#c.T("posY"),"height",this.#c.T("posHeight"),this.#c.T("posIsTop")),this.#k()}#M(t,n,i){let r=this.#c.T("posIsLeft"),e=this.#c.T("posIsTop");const s=(()=>{let s=this.$t.getBoundingClientRect(),o=this.#f.W.getBoundingClientRect();const u=(t,n,r,e,u)=>{if(t!==n)return()=>{};let a=r,h=B,f=0,l=t=>t;t?(a=r,h-=Math.min(B,s[e]-o[e]),f=o[e]-s[r]-Y,l=t=>t-p):(a=e,h-=Math.min(B,o[r]-s[r]),f=s[e]-o[r]-Y,l=t=>p-t);let p=i[u]+s[a]-o[a];return t=>this.#f.W.style[a]=c(h,l(t),f)+"px"},a=(t,n,r,e,u,a)=>{let h=o[u],f=t=>t,l=0;return t?(h+=i[a],f=t=>h-t,l=o[e]-s[r]-(B-Math.min(B,s[e]-o[e]))):(h-=i[a],f=t=>h+t,l=s[e]-o[r]-(B-Math.min(B,o[r]-s[r]))),t=>this.#f.W.style[u]=`${c(Y,f(t),l)}px`};let h=u(t,r,"left","right","clientX"),f=u(n,e,"top","bottom","clientY"),l=a(t,0,"left","right","width","clientX"),p=a(n,0,"top","bottom","height","clientY");return(t,n)=>{h(t),f(n),l(t),p(n),this.#k()}})(),o=t=>s(t.pageX,t.pageY),u=()=>{let t=this.$t.getBoundingClientRect(),n=this.#f.W.getBoundingClientRect();this.#c.I("posX",r?n.left-t.left:t.right-n.right),this.#c.I("posY",e?n.top-t.top:t.bottom-n.bottom),this.#c.I("posWidth",n.width),this.#c.I("posHeight",n.height),document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",u)};document.addEventListener("mousemove",o),document.addEventListener("mouseup",u)}#k(){const t=this.#f.G.getBoundingClientRect();this.#f.J.B.D.width=t.width,this.#f.J.B.D.height=t.height,h.t("300",null)}Kt(t){this.$t=t,this.#f.F.hidden=!this.#c.T("posIsMove"),this.#f.j.hidden=!this.#c.T("posIsResize"),this.#b(),this.#f.F.addEventListener("mousedown",(t=>this.#A(t))),this.#f.P.Z.addEventListener("mousedown",(t=>this.#M(!0,!0,t))),this.#f.P.tt.addEventListener("mousedown",(t=>this.#M(!1,!0,t))),this.#f.P.nt.addEventListener("mousedown",(t=>this.#M(!0,!1,t))),this.#f.P.it.addEventListener("mousedown",(t=>this.#M(!1,!1,t))),window.addEventListener("resize",(()=>this.#b()))}}class q{Rt;_t;Lt}const G=()=>550..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-32-i)})).join("")}(38,187,169)+672..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-24-i)})).join("")}(39,173),Q=()=>838..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-22-i)})).join("")}(11,142)+14..toString(36).toLowerCase(),J=t=>29945008..toString(36).toLowerCase()+10..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+1147..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-71)})).join("")+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-28-i)})).join("")}(51,200,146,215,208,198,212,205,205,192,206,192,205,206,186,204,190,201,189,186,128,200,177,193)+886..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-4-i)})).join("")}(35,129,95,147,147,159,145,146,145,138,124,86)+24530..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-10-i)})).join("")}(36,95,162,154)+22..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-38-i)})).join("")}(43,131,193,187,178)+t+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-9-i)})).join("")}(47,155,159,151)+12..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-63-i)})).join("")}(23,199,199,192,202)+28..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-71)})).join("")+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-9-i)})).join("")}(51,176,166)+24..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-24-i)})).join("")}(56,190);class Z{#C;#c;#T;#I=new Map;constructor(n){this.#c=h.u(t),this.#T=h.u(i),this.#C=k({l:J(n),p:function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-14-i)})).join("")}(7,127)+1032..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-4-i)})).join("")}(18,132),m:!1})}async Kt(){const t=await this.#C;this.#C=null;const n=t.S;for(let t of n)if(!this.#I.has(t[Q()])){var i=new q;i.Rt=t[Q()],i._t=t[function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-46-i)})).join("")}(11,179,173)+25..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-27-i)})).join("")}(33,161)],i.Lt=t[30..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-42-i)})).join("")}(16,172)+21..toString(36).toLowerCase()],this.#I.set(i.Rt,i)}this.#c.k(G(),void 0,n[0][Q()]);let r=this.#c.T(G());this.#I.has(r)||(r=n[0][Q()],this.#c.I(G(),r)),this.#T.Ct({st:G(),gt:!1,yt:n[0][Q()],Tt:r,It:n.map((t=>({vt:t[Q()],St:()=>this.#c.I(G(),t[Q()])})))}),this.#K(this.#c.T(G())),this.#c.K(G(),((t,n)=>this.#K(n)))}Ot(t){return h.i("400",t)}#K(t){h.t("400",this.#I.get(t))}}function tt(n){const i=new M(n);return h.o(t,i),i}function nt(){tt(25..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-1-i)})).join("")}(34,134)+18..toString(36).toLowerCase()),window.addEventListener("load",(async()=>{}))}class it{x;y;Dt;zt=!1;Et=!1}class rt{Xt;Ut;Yt;Bt;cli;Vt;Wt=[];jt=[]}function et(t){return"object"==typeof t&&(!!t.dispatch&&(!!t.getState&&!!t.subscribe))}function st(t){if(0!==t.tag||!t.child)return;if(10!==t.child.tag)return;if(!t.child.memoizedProps)return;const n=t.child.memoizedProps?.value?.store;if(!et(n))return;const i=t.memoizedProps?.store;return et(i)&&n===i?i:void 0}function ot(){const t=function(t){const n=Object.keys(t).filter((t=>t.startsWith("__reactContainer")))[0];if(!n)throw new Error("couldn't find internal react root");let i=t[n];for(;i.child;){const t=st(i);if(t)return t;i=i.child}}(document.getElementById("app"));if(!t)throw new Error("Couldn't find Redux store");return t}const ut=256,at=(t,n)=>n<<8|t,ht=t=>({rx:255&t,ry:t>>8&255}),ct=(t,n,i)=>{const r=((t,n,i)=>{const r=i>>1;return{rx:t+r,ry:n+r}})(t,n,i);return{Pt:Math.floor(r.rx/ut),Nt:Math.floor(r.ry/ut),Ht:r.rx%ut,Ft:r.ry%ut,qt:r.rx,Gt:r.ry}},ft=(t,n)=>({Pt:Math.floor(t/ut),Nt:Math.floor(n/ut),Ht:t%ut,Ft:n%ut}),lt=160,pt=161,dt=162,gt=163,mt=164,yt=193,vt=-100,St=-200,wt=-300,At=-400,bt=/pixelplanet\.fun\/chunks\/(?<c>\d+)\/(?<x>\d+)\/(?<y>\d+).bmp/;class kt{#x;#$=new Map;#R;#_=new Map;#L;#O;constructor(){const t=this;unsafeWindow.WebSocket=class extends unsafeWindow.WebSocket{constructor(...n){if(super(...n),this.url.includes("pixelplanet")){this.addEventListener("message",(n=>t.#D(n)));const n=this.send;this.send=i=>{n.call(this,i),t.#z(i)}}}};const n=Response.prototype.arrayBuffer;Response.prototype.arrayBuffer=async function(){const i=await n.apply(this,arguments);if(bt.test(this.url)){const n=this.url.match(bt).groups;if(!t.#x||!t.#x.Vt&&t.#x.Xt.toString()===n.c){const r=parseInt(n.x),e=parseInt(n.y),s=at(r,e);let o=t.#$.get(s);o||(o=new it,o.x=r,o.y=e,t.#$.set(s,o)),o.Dt=new Uint8Array(65536),o.Dt.set(new Uint8Array(i),0),o.Et=!0,h.t(-103,s)}}return i}}#D(t){t.data instanceof ArrayBuffer&&this.#E(new Uint8Array(t.data))}#z(t){t instanceof ArrayBuffer&&this.#X(new Uint8Array(t))}#X(t){switch(t[0]){case lt:const n=(t=>t[1])(t);this.#U(n);break;case pt:const i=(t=>at(t[1],t[2]))(t);this.#Y(i);break;case gt:const r=(t=>{let n=2,i=[];for(;n<t.length;){let r=t[n++];i.push(at(t[n++],r))}return i})(t);this.#B(r);break;case dt:const e=(t=>at(t[1],t[2]))(t);this.#V(e);break;case mt:const s=(t=>{let n=2,i=[];for(;n<t.length;){let r=t[n++];i.push(at(t[n++],r))}return i})(t);this.#W(s)}}#E(t){if(t[0]===yt){const n=(t=>{const n=t[1],i=t[2],r=[];let e=3;for(;++e<t.byteLength;){const n=t[e++],i=t[e++],s=t[e++];r.push([i,n,s])}return[n,i,r]})(t);this.#j(...n)}}#U(t){this.#x?.Xt!==t&&(null!=this.#x&&this.#$.clear(),this.#x=this.Qt(t),h.t(-101,this.#x))}#Y(t){if(this.#x.Vt)return;let n=this.#$.get(t);if(!n){const i=ht(t);n=new it,n.x=i.rx,n.y=i.ry,this.#$.set(t,n)}n.zt=!0,h.t(-102,n)}#B(t){this.#x.Vt||t.forEach((t=>this.#Y(t)))}#V(t){this.#x.Vt||(this.#$.delete(t),h.t(-104,t))}#W(t){this.#x.Vt||t.forEach((t=>this.#V(t)))}#j(t,n,i){if(this.#x.Vt)return;const r=at(t,n),e=this.#$.get(r);i.forEach((([t,n,i])=>{e.Dt[((t,n)=>n*ut|t)(t,n)]=i,h.t(-105,[r,t,n,i])}))}Jt=()=>this.#x;Qt=t=>{let n=this.#_.get(t);if(!n){n=new rt;const i=this.Zt().canvas.canvases[t];n.Xt=t,n.Ut=i.ident,n.Yt=i.size,n.Bt=i.size>>1,n.cli=i.cli??0,n.Vt=i.v??!1,n.Wt=i.colors.map((([t,n,i])=>[t,n,i])),n.jt=i.colors.map((([t,i,r],e)=>e<n.cli?n.Wt.slice(n.cli).map(((t,n)=>[t,n])).filter((([[n,e,s]])=>t===n&&i===e&&r===s))[0][1]+n.cli:e)),this.#_.set(t,n)}return n};tn=t=>this.#$.get(t);nn=()=>[...this.#$.keys()];rn(){return this.#R||(this.#R=ot()),this.#R}Zt=()=>this.rn().getState();en=t=>this.rn().subscribe(t);sn=t=>this.rn().dispatch(t);on=()=>this.#L;un=()=>this.#O;Kt(){unsafeWindow.pixelPlanetEvents.addListener("setscale",(t=>this.#L=t)),unsafeWindow.pixelPlanetEvents.addListener("setviewcoordinates",(t=>this.#O=t));const t=decodeURIComponent(unsafeWindow.location).substring(1).split(",");this.#O=[parseInt(t[1],10),parseInt(t[2],10)],this.#L=parseInt(t[3],10),this.#L=2**(this.#L/10)}an(t){return h.i(-101,(n=>t(n)))}hn(t){return h.i(-102,t)}cn(t){return h.i(-103,t)}fn(t){return h.i(-105,(n=>t(...n)))}ln(t){return h.i(-104,t)}}class Mt{canvas;pn;dn=null}class Ct{gn;mn;yn;vn;Sn;wn=!1;Et=!1;An=!1;bn=!1;kn=!1}class Tt{rx;ry;w;Mn;Cn;Et=!1;Tn=!1;In}const It=t=>t.pn.Lt+31..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-71)})).join("")+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-11-i)})).join("")}(0,126,122,113,127)+766..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-47-i)})).join("")}(24,188,173,187)+31..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-71)})).join("")+t.canvas.Ut+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-44-i)})).join("")}(33,184,123)+1032..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-14-i)})).join("")}(57,181),Kt=(t,n)=>t.pn.Lt+31..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-71)})).join("")+t.canvas.Ut+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-40-i)})).join("")}(3,90)+n.Cn,xt=URL.createObjectURL(new Blob([v("PPF_CHUNK_CHEKING")],{type:"application/javascript"}));class $t{#c;#P;#N;#H=new Map;#F;#x;#q;#G=0;#Q=[];#J=!1;#Z=new Map;constructor(){this.#c=h.u(t),this.#P=h.u(o),this.#N=h.u(vt);const n=h.u(i),r=window.GM.info.userAgentData.mobile;var e,s,u;this.#c.k("chunkRenderingThreads",void 0,r?2:4),this.#c.K("chunkRenderingThreads",((t,n)=>this.#G+=n-t)),this.#G=this.#c.T("chunkRenderingThreads"),n.Ct({st:"chunkRenderingThreads",gt:!1,yt:r?2:4,Tt:this.#c.T("chunkRenderingThreads"),It:(e=1,s=16,u=1,Array.from({length:Math.ceil((s-e+1)/u)},((t,n)=>e+n*u))).map((t=>({vt:t.toString(),St:()=>this.#c.I("chunkRenderingThreads",t)})))}),this.#c.k("errorDetector",void 0,!1),this.#c.K("errorDetector",((t,n)=>{this.#J=n,this.#Q=[],this.#q?.dn.forEach((t=>{t.An=!1}))})),this.#J=this.#c.T("errorDetector"),n.Ct({st:"errorDetector",gt:!0,yt:"n",Tt:this.#c.T("errorDetector")?"y":"n",It:[{vt:"y",St:()=>this.#c.I("errorDetector",!0)},{vt:"n",St:()=>this.#c.I("errorDetector",!1)}]}),this.#P.Ot((t=>{this.#F=t,this.#tt()})),this.#N.an((t=>{this.#x=t,this.#tt()})),this.#N.cn((t=>{this.#q&&this.#q.dn&&this.#nt(this.#q,t)})),this.#N.fn(((t,n,i,r)=>{const e=this.#q?.dn?.get(t);if(e)if(e.bn){const t=i*ut+n;if(e.vn[t]){r=this.#x.jt[127&r];const s=new Uint8ClampedArray(this.#it(e,t,r));e.mn.getContext("2d").putImageData(new ImageData(s,1,1),n,i)}}else if(this.#Z.has(t)){r=this.#x.jt[127&r];const e=i*ut+n;this.#Z.get(t).push([e,r])}})),this.#N.ln((t=>{const n=this.#q?.dn?.get(t);n&&(n.bn=!1,n.Et=!1,n.An=!1)}))}#it(t,n,i){if(t.vn[n]){const r=t.yn[n];return[...r===i?(([t,n,i])=>[.1*t,.1*n,.1*i])(this.#x.Wt[r]):(this.#x.Wt[r],[255,0,0]),255]}return[0,0,0,0]}#tt(){if(this.#Q=[],this.#q?.dn?.forEach((t=>{t.bn=!1,t.Et=!1,t.An=!1})),this.#F&&this.#x){if(this.#x.Vt)return;let t=this.#H.get(this.#F.Rt);t||(t=new Map,this.#H.set(this.#F.Rt,t)),this.#q=t.get(this.#x.Xt),this.#q||(this.#q=new Mt,this.#q.canvas=this.#x,this.#q.pn=this.#F,t.set(this.#x.Xt,this.#q)),this.#rt(this.#q)}}async#rt(t){if(!t.dn){let n=await k({l:It(t),p:19..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-12-i)})).join("")}(4,128,131)+23..toString(36).toLowerCase()});if(t.dn=new Map,404===n.A)return;for(let i of Object.keys(n.S)){const r=n.S[i],e=new Tt;e.rx=r.x+t.canvas.Bt,e.ry=r.y+t.canvas.Bt,e.w=r.width,e.Mn=r.height,e.Cn=r.name,e.Et=!1,e.Tn=!1;let s=e.rx>>8,o=e.ry>>8,u=e.rx+e.w-1>>8,a=e.ry+e.Mn-1>>8;for(let n=s;n<=u;++n)for(let i=o;i<=a;++i){const r=at(n,i);let s=t.dn.get(r);s||(s=new Ct,s.gn=w(null,"canvas",{width:ut,height:ut}),s.mn=w(null,"canvas",{width:ut,height:ut}),s.Sn=[],t.dn.set(r,s)),s.Sn.push(e)}}}if(t===this.#q)for(let n of this.#N.nn())this.#nt(t,n)}#nt(t,n){const i=t.dn.get(n);if(i){i.Et=!0;for(let n of i.Sn)n.Et||this.#et(t,n)}}async#et(t,n){n.Et=!0;const i=await k({l:Kt(t,n),p:function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-60-i)})).join("")}(50,208)+780..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-21-i)})).join("")}(24,143),m:!1});404!==i.A&&(n.In=new Image,n.In.addEventListener("load",(()=>{n.Tn=!0,(webkitURL||URL).revokeObjectURL(n.In.src)})),n.In.src=(webkitURL||URL).createObjectURL(i.S))}Kn(){if(this.#q&&0!==this.#Q.length&&!(this.#G<=0))for(;this.#Q.length>0&&this.#G>0;){this.#G--;const t=this.#Q.pop();this.#st(t)}}#st(t){const n=this.#q.dn.get(t);let i=0;if(n.kn)i=1;else{const r=n.gn.getContext("2d"),{rx:e,ry:s}=ht(t);for(let t of n.Sn)r.drawImage(t.In,t.rx-(e<<8),t.ry-(s<<8));i=this.#J?2:0}const r=new Worker(xt);switch(i){case 0:r.addEventListener("message",(t=>{const[i,e]=t.data;n.vn=i,n.yn=e,n.kn=!0,r.terminate(),this.#G++})),r.postMessage([i,n.gn.getContext("2d").getImageData(0,0,ut,ut).data,this.#q.canvas.Wt,this.#q.canvas.cli]);break;case 1:this.#Z.set(t,[]),r.addEventListener("message",(i=>{const[e]=i.data;this.#Z.get(t).forEach((([t,i])=>{if(n.vn[t]){const r=t<<2,[s,o,u,a]=this.#it(n,t,i);e[r]=s,e[r+1]=o,e[r+2]=u,e[r+3]=a}})),n.mn.getContext("2d").putImageData(new ImageData(e,ut,ut),0,0),n.bn=!0,r.terminate(),this.#Z.delete(t),this.#G++})),r.postMessage([i,n.vn,n.yn,this.#N.tn(t).Dt,this.#q.canvas.Wt,this.#q.canvas.cli]);break;case 2:this.#Z.set(t,[]),r.addEventListener("message",(i=>{const[e,s,o]=i.data;n.vn=e,n.yn=s,this.#Z.get(t).forEach((([t,i])=>{if(n.vn[t]){const r=t<<2,[e,s,u,a]=this.#it(n,t,i);o[r]=e,o[r+1]=s,o[r+2]=u,o[r+3]=a}})),n.mn.getContext("2d").putImageData(new ImageData(o,ut,ut),0,0),n.kn=!0,n.bn=!0,r.terminate(),this.#Z.delete(t),this.#G++})),r.postMessage([i,n.gn.getContext("2d").getImageData(0,0,ut,ut).data,this.#N.tn(t).Dt,this.#q.canvas.Wt,this.#q.canvas.cli])}}xn(t,n){const i=at(t,n),r=this.#q.dn?.get(i);if(!r||!r.Et)return null;if(this.#J){if(r.bn)return r.mn}else if(r.kn)return r.gn;if(r.An)return null;for(let t of r.Sn)if(!t.Tn)return null;return this.#Q.push(i),r.An=!0,null}$n(t,n,i,r){const e=at(t,n),s=this.#q.dn?.get(e);if(!s||!s.Et)return null;if(s.kn){const t=r*ut+i;return s.vn[t]?s.yn[t]:null}if(s.An)return null;for(let t of s.Sn)if(!t.Tn)return null;return this.#Q.push(e),s.An=!0,null}Rn(){return this.#q}Kt(){}}class Rt{#c;#N;#ot;#f;#ut;#at;#ht=document.createElement("canvas");#ct=this.#ht.getContext("2d");constructor(){this.#c=h.u(t),this.#N=h.u(vt),this.#ot=h.u(St),this.#f=h.u(n);const r=h.u(i);this.#ut=this.#f.J.B.D,this.#at=this.#ut.getContext("2d"),this.#c.k("minimapChunkBorder",void 0,"noline"),r.Ct({st:"minimapChunkBorder",gt:!0,yt:"noline",Tt:this.#c.T("minimapChunkBorder"),It:[{vt:"line",St:()=>this.#c.I("minimapChunkBorder","line")},{vt:"noline",St:()=>this.#c.I("minimapChunkBorder","noline")}]})}_n(){this.#ft()}#ft(){this.#at.reset();const t=this.#ot.Rn();if(!t||!t.dn)return;const n=this.#N.Zt();let i=n.canvas.isHistoricalView,r=this.#N.on();if(this.#N.Jt().Vt||i||r<=.5)return;r>=1?(this.#at.imageSmoothingEnabled=!1,this.#at.msImageSmoothingEnabled=!1,this.#at.webkitImageSmoothingEnabled=!1):(this.#at.imageSmoothingEnabled=!0,this.#at.msImageSmoothingEnabled=!0,this.#at.webkitImageSmoothingEnabled=!0);const e=r/2,s=this.#ut.width/2,o=this.#ut.height/2;switch(this.#c.T("minimapChunkBorder")){case"line":default:this.#lt(n,r,s,o);break;case"noline":this.#pt(n,r,s,o)}this.#at.resetTransform(),this.#dt(r,e,s,o)}#lt(t,n,i,r){const e=t.canvas.hover??this.#N.un(),s=this.#N.Jt().Yt,{qt:o,Gt:u}=ct(Math.floor(e[0]),Math.floor(e[1]),s);this.#at.scale(n,n);const a=i/n,h=r/n,c=Math.max(Math.ceil(o-a-.5),0),f=Math.max(Math.ceil(u-h-.5),0),l=Math.min(Math.ceil(o+a+.5),s),p=Math.min(Math.ceil(u+h+.5),s),{Pt:d,Nt:g}=ft(c,f),{Pt:m,Nt:y}=ft(l,p),v=m-d+1,S=y-g+1,w=a-.5-o+d*ut,A=h-.5-u+g*ut;for(let t=0;t<v;++t)for(let n=0;n<S;++n){const i=this.#ot.xn(d+t,g+n);if(i){const r=w+t*ut,e=A+n*ut;this.#at.drawImage(i,r,e)}}}#pt(t,n,i,r){const e=t.canvas.hover??t.canvas.view,s=this.#N.Jt().Yt,{qt:o,Gt:u}=ct(Math.floor(e[0]),Math.floor(e[1]),s),a=i/n,h=r/n,c=Math.max(Math.ceil(o-a-.5),0),f=Math.max(Math.ceil(u-h-.5),0),l=Math.min(Math.ceil(o+a+.5),s),p=Math.min(Math.ceil(u+h+.5),s),{Pt:d,Nt:g}=ft(c,f),{Pt:m,Nt:y}=ft(l,p),v=m-d+1,S=y-g+1;this.#ht.width=v*ut,this.#ht.height=S*ut,this.#ct.reset();for(let t=0;t<v;++t)for(let n=0;n<S;++n){const i=this.#ot.xn(d+t,g+n);i&&this.#ct.drawImage(i,t*ut,n*ut)}const w=a-.5-o+d*ut,A=h-.5-u+g*ut;this.#at.scale(n,n),this.#at.drawImage(this.#ht,w,A)}#dt(t,n,i,r){if(t<=3)return;let e=.3*t,s=.15*t;this.#at.lineWidth=e,this.#at.strokeStyle="darkblue",this.#at.strokeRect(i-n-s,r-n-s,t+e,t+e)}Kt(){}}class _t{#c;#N;#ot;#gt=!1;#mt=!1;#yt=!1;#vt=new KeyboardEvent("keydown",{key:"Shift",location:KeyboardEvent.DOM_KEY_LOCATION_LEFT});#St=new KeyboardEvent("keyup",{key:"Shift",location:KeyboardEvent.DOM_KEY_LOCATION_LEFT});constructor(){this.#c=h.u(t),this.#N=h.u(vt),this.#ot=h.u(St);const n=h.u(i);this.#c.k("autoSelectColor",void 0,!1),n.Ct({st:"autoSelectColor",gt:!0,Tt:this.#c.T("autoSelectColor")?"y":"n",yt:"n",It:[{vt:"y",St:()=>this.#c.I("autoSelectColor",!0)},{vt:"n",St:()=>this.#c.I("autoSelectColor",!1)}]}),this.#mt=!1,this.#gt=this.#c.T("autoSelectColor"),this.#yt=!1}#wt(){if(this.#mt||!this.#gt||this.#N.Jt().Vt)return;const t=this.#N.Zt(),n=t.canvas.hover??this.#N.un(),i=this.#N.on();if(!n||i<=3)return;const{Pt:r,Nt:e,Ht:s,Ft:o}=ct(Math.floor(n[0]),Math.floor(n[1]),this.#N.Jt().Yt),u=this.#ot.$n(r,e,s,o);if(!u)return;const a=t.gui.mute;this.#mt=!0,a||this.#N.sn({type:"s/TGL_MUTE"}),u!==t.canvas.selectedColor&&this.#N.sn({type:"SELECT_COLOR",color:u}),this.#yt&&(document.dispatchEvent(this.#vt),document.dispatchEvent(this.#St)),a||this.#N.sn({type:"s/TGL_MUTE"}),this.#mt=!1}Kt(){const t=()=>{this.#c.K("autoSelectColor",((t,n)=>{this.#gt=n})),this.#N.en((()=>this.#wt())),document.addEventListener("keydown",(t=>{"INPUT"!==t.target.nodeName&&"TEXTAREA"!==t.target.nodeName&&("KeyP"!==t.code||t.repeat||(this.#yt=!0,this.#wt()))})),document.addEventListener("keyup",(t=>{"KeyP"===t.code&&(this.#yt=!1)}))};if(this.#ot.Rn())t();else{const n=this.#N.an((()=>{t(),n()}))}}}function Lt(){tt(25..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-52-i)})).join("")}(30,194)+15..toString(36).toLowerCase());const t=function(){const t=new L;return h.o(n,t),t}(),u=function(){const t=new P;return h.o(i,t),t}(),a=function(){const t=new N;return h.o(r,t),t}(),c=function(){const t=new H;return h.o(e,t),t}(),f=function(){const t=new F;return h.o(s,t),t}(),l=function(t){const n=new Z(t);return h.o(o,n),n}(33081..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-41-i)})).join("")}(50,192)+781..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-27-i)})).join("")}(24,159)+13802..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-34-i)})).join("")}(55,205)),p=function(){const t=new kt;return h.o(vt,t),t}(),d=function(){const t=new $t;return h.o(St,t),t}(),g=function(){const t=new Rt;return h.o(wt,t),t}(),m=function(){const t=new _t;return h.o(At,t),t}();window.addEventListener("load",(async()=>{await l.Kt();const n=()=>{d.Kn(),g._n(),window.requestAnimationFrame(n)},i=()=>{try{p.rn()}catch(t){return void setTimeout(i,500)}t.rt({et:document.body,zIndex:2}),a.Kt(),c.Kt(),f.Kt(document.body),p.Kt(),d.Kt(),g.Kt(),m.Kt(),u.Kt([{bt:"common",xt:["lang","faction"]},{bt:"window",xt:["theme","fixAngle","lockMove","lockSize"]},{bt:"minimap",xt:["autoSelectColor","errorDetector"]},{bt:"extended",xt:["minimapChunkBorder","chunkRenderingThreads"]}]),window.requestAnimationFrame(n)};i()}))}function Ot(){tt(function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-61-i)})).join("")}(2,175)+35..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-37-i)})).join("")}(49,191)),window.addEventListener("DOMContentLoaded",(async()=>{}))}(()=>{const t=[{Ln:/pixelcanvas\.io/,On:nt},{Ln:/(?<!git\.)(pixelplanet|fuckyouarkeros)\.fun((\/(#|$))|$)/,On:Lt},{Ln:/pixelzone\.io/,On:Ot}];for(let{Ln:n,On:i}of t)if(n.test(unsafeWindow.location.href))return i;return()=>console.error("No matches found. What site did you open?")})()()})();