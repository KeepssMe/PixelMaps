// ==UserScript==
// @name Pixel Minimap (Test)
// @description I'll make minimaps. Maybe
// @version 0.1.11
// @author KeepssMe. Thank you Sallbet for testing and listening to my whining
// @exclude *git.pixelplanet.fun/*
// @match *.pixelplanet.fun/*
// @match *pixelplanet.fun/*
// @match *fuckyouarkeros.fun/*
// @match *pixelzone.io/*
// @match *pixelcanvas.io/*
// @connect raw.githubusercontent.com
// @downloadURL https://raw.githubusercontent.com/KeepssMe/PixelMaps/test/minimap.user.js
// @grant unsafeWindow
// @grant GM_addStyle
// @grant GM_addElement
// @grant GM_getResourceText
// @grant GM_listValues
// @grant GM_setValue
// @grant GM_getValue
// @grant GM_deleteValue
// @grant GM_registerMenuCommand
// @grant GM_xmlhttpRequest
// @resource TRANSLATIONS https://raw.githubusercontent.com/KeepssMe/PixelMaps/test/translations.json
// @resource STYLES https://raw.githubusercontent.com/KeepssMe/PixelMaps/test/styles.css
// @resource VIEWS https://raw.githubusercontent.com/KeepssMe/PixelMaps/test/views.html
// @run-at document-start
// @sandbox raw
// @updateURL https://raw.githubusercontent.com/KeepssMe/PixelMaps/test/minimap.user.js
// ==/UserScript==

(()=>{const t=100,n=200,i=201,r=202,e=203,s=204,o=300,u="100_",a="200";const h=new class{#t=new Map;#n=new Map;t(t,n){const i=this.#t.get(t);i&&i.forEach((t=>t(n)))}i(t,n){let i=this.#t.get(t);return i||(i=[],this.#t.set(t,i)),i.push(n),()=>{const i=this.#t.get(t);0===i.length?this.#t.delete(t):this.#t.set(t,i.filter((t=>t!==n)))}}o(t,n){this.#n.has(t)||this.#n.set(t,n)}u(t){return this.#n.get(t)}h(){this.t(a,null)}};function c(t,n,i){return Math.max(t,Math.min(n,i))}function f(t,n,i){return Array.from({length:Math.ceil((n-t+1)/i)},((n,r)=>t+r*i))}const l=new Error("Incorrect value type");function p(t){switch(typeof t){case"number":case"boolean":case"string":case"bigint":case"undefined":return t;case"object":if(null===t)return null;let n=Array.isArray(t)?[]:{};for(let i in t)t.hasOwnProperty(i)&&(n[i]=p(t[i]));return n;default:throw l}}function d(t,n){if(t===n)return!0;const i=typeof t;if(i!==typeof n)return!1;switch(i){case"number":case"boolean":case"string":case"bigint":case"undefined":return!1;case"object":if(null===t)return!1;let i=Array.isArray(t);if(i!==Array.isArray(n))return!1;if(i){if(t.length!==n.length)return!1;for(let i=0;i<t.length;++i)if(!d(t[i],n[i]))return!1;return!0}let r=Object.keys(t);if(r.length!==Object.keys(n).length)return!1;for(let i of r)if(!d(t[i],n[i]))return!1;return!0;default:throw l}}const g=window[23..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-14-i)})).join("")}(32,123)+21..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-13)})).join("")+1004141..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-54-i)})).join("")}(31,205,195,183,171)+14..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-26-i)})).join("")}(32,173)],m=window[function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-0-i)})).join("")}(43,114)+29..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+21..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-13)})).join("")+590..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-20-i)})).join("")}(3,139)+12..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-13)})).join("")+381..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-15-i)})).join("")}(12,144)+14..toString(36).toLowerCase()],y=window[function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-27-i)})).join("")}(6,138,151,130,111,104)+29..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-0-i)})).join("")}(61,181,171,159,147)+14..toString(36).toLowerCase()],v=window[857..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-2-i)})).join("")}(59,172,164,162,156)+19202..toString(36).toLowerCase()+12..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-13)})).join("")+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-34-i)})).join("")}(22,153)+28310..toString(36).toLowerCase()],S=window[function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-18-i)})).join("")}(33,148,129,122)+21269..toString(36).toLowerCase()+34..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+690366..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-8-i)})).join("")}(14,122,136)+14..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-63-i)})).join("")}(19,204,184,166)+29..toString(36).toLowerCase()],w=window[857..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+21..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-13)})).join("")+10..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-45-i)})).join("")}(38,202,168,184,183)+1245..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-14-i)})).join("")}(22,137)],A=(window[function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-35-i)})).join("")}(48,183,180,161,154)+481..toString(36).toLowerCase()+21..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+27742..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-45-i)})).join("")}(41,187)+23..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-52-i)})).join("")}(34,202)],window[857..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+21..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-13)})).join("")+35512..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-21-i)})).join("")}(33,179,171,161,136,172,158,172,170,159)+19..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+41366111..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-43-i)})).join("")}(16,159)]),k=(window[857..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+21..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-13)})).join("")+30..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-61-i)})).join("")}(11,192,181,178,175,187,182)+38115..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-5-i)})).join("")}(24,131,106)+23..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-3-i)})).join("")}(55,170,171,126,175)+28895..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-61-i)})).join("")}(52,213)],window[23..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-10-i)})).join("")}(3,90)][function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-19-i)})).join("")}(29,158,168)+21..toString(36).toLowerCase()+24..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+29..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-13-i)})).join("")}(22,139,119,148,151)+1252468..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-13-i)})).join("")}(12,141)]),b=async t=>{const n={};n[30..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-28-i)})).join("")}(18,160)+21..toString(36).toLowerCase()]=t.l,t.p&&(n[function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-38-i)})).join("")}(19,171)+690396..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-0-i)})).join("")}(45,161,155)+14..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-35-i)})).join("")}(24,181,143)+914..toString(36).toLowerCase()]=t.p);let i=await k(n);return{m:i[1037..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-37-i)})).join("")}(31,185,165)+1108..toString(36).toLowerCase()],S:i[986..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-38-i)})).join("")}(30,181,181,181,183)+28..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-8-i)})).join("")}(24,133)]}};class M{static{const t=window.GM.info.script.version;m("version",void 0)!==t&&(g().forEach((t=>v(t))),y("version",t))}#i=new Map;#r;#e=t=>this.#r+t;constructor(t){this.#r=t+"_",h.i(a,(()=>this.#s()))}A(t,n,i){if(this.#i.has(t))return;if(void 0===n&&void 0===i)return;const r=this.#e(t);let e=m(r,void 0);if(void 0===e){const t=void 0===n?i:n;void 0!==t&&(e=t,y(r,t))}let s={k:p(e),M:void 0};this.#i.set(t,s),void 0!==i&&(s.M=p(i))}T(t){if(this.#i.has(t))return p(this.#i.get(t).k);const n=m(this.#e(t),void 0);return this.#i.set(t,{k:n,M:void 0}),p(n)}I(t,n){if(!this.#i.has(t)){const n=m(this.#e(t),void 0);this.#i.set(t,{k:n,M:void 0})}let i=this.#i.get(t);if(d(n,i.k))return;const r=i.k;i.k=p(n),y(this.#e(t),n),this.#o(t,r,i.k)}#s(){for(let[t,n]of this.#i.entries()){if(void 0===n.M||d(n.k,n.M))continue;const i=n.k;n.k=p(n.M),y(this.#e(t),n.k),this.#o(t,i,n.k)}}#o(t,n,i){h.t(u+t,[p(n),p(i)])}C(t,n){return h.i(u+t,(t=>n(t[0],t[1])))}}class T{K;$;constructor(t,n){this.K=t,this.$=n}}const I=(new DOMParser).parseFromString(S(function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-1-i)})).join("")}(26,113)+25..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-11-i)})).join("")}(35,115)+13..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-13)})).join("")+35..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")),"text/html").body.children;function C(t){if(t>I.length)throw new Error(`View with index ${t} not found`);return I.item(t).cloneNode(!0)}function K(t,n,i){return t.querySelectorAll(n).item(i)}class x extends T{O;_;constructor(t,n){super(t,n),this._=K(this.K,".minimap_tab-menu-buttons",0),this.O=[]}L(){const t=function(t,n={},i=null){const r=document.createElement(t);if(n)for(let t of Object.keys(n))r.setAttribute(t,n[t]);return i&&i.insertAdjacentElement("beforeend",r),r}("button",{},this._);this.O.push(t)}}class $ extends T{R;X;constructor(t,n){super(t,n),this.R=K(this.K,".minimap_canvas",0),this.X=K(this.K,".minimap_fast-functions",0)}}class O extends T{Y;constructor(t,n){super(t,n),this.Y=K(this.K,".minimap_tab-settings-detail",0)}}class _{B;V;P}class L{D;U;W;j;N;H;F;q;Z=new _;constructor(){this.D=C(1),this.U=K(this.D,".minimap_resizers",0),this.W={G:K(this.U,".minimap_resizer-lt",0),J:K(this.U,".minimap_resizer-rt",0),tt:K(this.U,".minimap_resizer-lb",0),nt:K(this.U,".minimap_resizer-rb",0)},this.j=K(this.D,".minimap_header-menu",0),this.N=K(this.D,".minimap_header-status",0),this.H=K(this.D,".minimap_header-move",0),this.F=K(this.D,".minimap_header-close",0),this.q=K(this.D,".minimap_main",0),this.Z.B=new x(K(this.D,".minimap_tab-menu",0),"menu"),this.Z.V=new $(K(this.D,".minimap_tab-main",0),"main"),this.Z.B.L(),this.Z.P=new O(K(this.D,".minimap_tab-settings",0),"settings"),this.Z.B.L()}it(t){w(S(function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-27-i)})).join("")}(54,164)+375..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-13)})).join("")+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-5-i)})).join("")}(24,114,99,105))),t.rt.insertAdjacentElement("afterbegin",C(0)),this.D.style.zIndex=t.zIndex,t.rt.insertAdjacentElement("beforeend",this.D)}}const z=new Map;let R;function X(){return R}function Y(t){return z.get(t)}(()=>{let t=JSON.parse(S(10..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-13)})).join("")+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-40-i)})).join("")}(39,161)+17..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-52-i)})).join("")}(27,147,157,163,157)+10..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-13)})).join("")+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-62-i)})).join("")}(28,163)+1146..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-35-i)})).join("")}(5,123)));if(0==t.length)throw new Error("Could not find a translation");for(let n of t)if(!z.has(n.name)&&(z.set(n.name,(t=>n.translations[t]??t)),!R&&n.langs))for(let t of n.langs)navigator.languages.includes(t)&&(R=n.name);R||(R=t[0].name)})();const B="setting_",V=["dark","darkmini"],E=200,P=50;class D{et;st;ot;ut;constructor(t){this.et=t,this.st=C(3),this.ot=K(this.st,".minimap_setting-name",0),this.ut=K(this.st,".minimap_setting-value",0)}ht(){}ct(t){this.ot.textContent=t(`${B}${this.et}`)}}class U extends D{ft;lt=new Map;dt;gt;constructor(t,n,i,r,e){super(t),this.dt=n,this.gt=i,this.ft=document.createElement("select"),this.ut.insertAdjacentElement("beforeend",this.ft);for(let{yt:t,vt:n}of e){const i=document.createElement("option");i.value=t,i.textContent=t,this.ft.insertAdjacentElement("beforeend",i),this.lt.set(t,{St:i,wt:n})}this.ft.value=r,this.ft.addEventListener("change",(()=>this.#u()))}ht(){this.ft.value=this.gt,this.#u()}#u(){this.lt.get(this.ft.value).wt()}ct(t){if(super.ct(t),this.dt)for(let{St:n}of this.lt.values())n.textContent=t(`${B}${this.et}_${n.value}`)}}class W{At;kt;bt;constructor(t){this.At=t,this.kt=C(2),this.bt=K(this.kt,"summary",0)}ct(t){this.bt.textContent=t(`group_${this.At}`)}}class j{#a=[];#h=new Map;#c;#f;#l;constructor(){this.#c=h.u(t),this.#f=h.u(n),this.#c.A("lang",void 0,X()),this.Mt({et:"lang",dt:!0,gt:X(),Tt:this.#c.T("lang"),It:[...z.keys()].map((t=>({yt:t,vt:()=>this.#c.I("lang",t)})))}),this.#c.C("lang",((t,n)=>this.#p(n))),h.i(a,(()=>this.#h.forEach((t=>t.ht()))))}Mt(t){if(this.#h.has(t.et))return;const n=new U(t.et,t.dt,t.gt,t.Tt,t.It);this.#h.set(n.et,n)}Ct(t){for(let{At:n,Kt:i}of t){const t=new W(n);this.#a.push(t),this.#f.Z.P.Y.insertAdjacentElement("beforeend",t.kt);for(let n of i){const i=this.#h.get(n);i&&t.kt.insertAdjacentElement("beforeend",i.st)}}this.#l=A("Reset minimap",(()=>h.h())),this.#p(this.#c.T("lang"))}#p(t){const n=Y(t);this.#l=A(n("gm_menu_reset"),(()=>h.h()),{id:this.#l});for(let t of this.#a.values())t.ct(n);for(let t of this.#h.values())t.ct(n)}}class N{#c;D;constructor(){this.#c=h.u(t);const r=h.u(n),e=h.u(i);this.D=r.D,this.#c.A("theme",void 0,V[0]),e.Mt({et:"theme",dt:!1,gt:V[0],Tt:this.#c.T("theme"),It:V.map((t=>({yt:t,vt:()=>this.#c.I("theme",t)})))}),this.#c.C("theme",((t,n)=>this.D.setAttribute("theme",n)))}Ct(){this.D.setAttribute("theme",this.#c.T("theme"))}}class H{#c;#f;#d=null;#g=null;#m=null;#y;#v=new Map;constructor(){this.#c=h.u(t),this.#f=h.u(n),this.#y=Y(this.#c.T("lang")),this.#c.C("lang",((t,n)=>{this.#y=Y(n),this.#p()}));let i=this.#f.Z.B,r=[this.#f.Z.V,this.#f.Z.P];for(let t=0;t<i.O.length;++t)this.#v.set(r[t].$,i.O[t]),i.O[t].addEventListener("click",(()=>this.#S(r[t])));this.#f.j.addEventListener("click",(()=>{this.#m===this.#f.Z.B?this.#S(this.#g):this.#S(this.#f.Z.B)})),this.#f.F.addEventListener("click",(()=>{this.#S(this.#f.Z.V)})),this.#f.D.addEventListener("mouseenter",(()=>{this.#d&&(clearTimeout(this.#d),this.#d=null)})),this.#f.D.addEventListener("mouseleave",(()=>{this.#m!==this.#f.Z.V&&(this.#d=setTimeout((()=>this.#S(this.#f.Z.V)),5e3))}))}#S(t){t!==this.#m&&(this.#f.F.hidden=t===this.#f.Z.V,t.K.hidden=!1,this.#m.K.hidden=!0,this.#f.N.textContent=this.#w(t.$),this.#g=this.#m,this.#m=t)}Ct(){this.#m=this.#f.Z.V,this.#y=Y(this.#c.T("lang")),this.#p()}#p(){this.#f.N.textContent=this.#w(this.#m.$);for(let[t,n]of this.#v.entries())n.textContent=this.#w(t)}#w=t=>this.#y(`tab_${t}`)}class F{#c;#f;xt;constructor(){this.#c=h.u(t),this.#f=h.u(n);const r=h.u(i);this.#c.A("posIsLeft",void 0,!1),this.#c.A("posIsTop",void 0,!0),this.#c.A("posX",void 0,0),this.#c.A("posY",void 0,0),this.#c.A("posIsMove",void 0,!1),this.#c.A("posWidth",void 0,300),this.#c.A("posHeight",void 0,300),this.#c.A("posIsResize",void 0,!0),r.Mt({et:"fixAngle",dt:!0,gt:"rt",Tt:`${this.#c.T("posIsLeft")?"l":"r"}${this.#c.T("posIsTop")?"t":"b"}`,It:[{yt:"lt",vt:()=>{this.#c.I("posIsLeft",!0),this.#c.I("posIsTop",!0)}},{yt:"rt",vt:()=>{this.#c.I("posIsLeft",!1),this.#c.I("posIsTop",!0)}},{yt:"lb",vt:()=>{this.#c.I("posIsLeft",!0),this.#c.I("posIsTop",!1)}},{yt:"rb",vt:()=>{this.#c.I("posIsLeft",!1),this.#c.I("posIsTop",!1)}}]}),r.Mt({et:"lockMove",dt:!0,gt:"y",Tt:this.#c.T("posIsMove")?"n":"y",It:[{yt:"y",vt:()=>this.#c.I("posIsMove",!1)},{yt:"n",vt:()=>this.#c.I("posIsMove",!0)}]}),r.Mt({et:"lockSize",dt:!0,gt:"n",Tt:this.#c.T("posIsResize")?"n":"y",It:[{yt:"y",vt:()=>this.#c.I("posIsResize",!1)},{yt:"n",vt:()=>this.#c.I("posIsResize",!0)}]}),this.#c.C("posIsLeft",((t,n)=>{let i=this.xt.getBoundingClientRect(),r=this.#f.D.getBoundingClientRect();this.#c.I("posX",n?r.left-i.left:i.right-r.right)})),this.#c.C("posIsTop",((t,n)=>{let i=this.xt.getBoundingClientRect(),r=this.#f.D.getBoundingClientRect();this.#c.I("posY",n?r.top-i.top:i.bottom-r.bottom)})),this.#c.C("posX",((t,n)=>{this.#c.T("posIsLeft")?(this.#f.D.style.left=n+"px",this.#f.D.style.right=null):(this.#f.D.style.left=null,this.#f.D.style.right=n+"px")})),this.#c.C("posY",((t,n)=>{this.#c.T("posIsTop")?(this.#f.D.style.top=n+"px",this.#f.D.style.bottom=null):(this.#f.D.style.top=null,this.#f.D.style.bottom=n+"px")})),this.#c.C("posIsMove",((t,n)=>this.#f.H.hidden=!n)),this.#c.C("posWidth",((t,n)=>this.#f.D.style.width=`${n}px`)),this.#c.C("posHeight",((t,n)=>this.#f.D.style.height=`${n}px`)),this.#c.C("posIsResize",((t,n)=>this.#f.U.hidden=!n))}#A(t){let n=this.#c.T("posIsLeft"),i=this.#c.T("posIsTop");const r=(()=>{let r=this.xt.getBoundingClientRect(),e=this.#f.D.getBoundingClientRect(),s=r.width-e.width,o=r.height-e.height,u=n?{v:"left",f:t=>t-h}:{v:"right",f:t=>h-t},a=i?{v:"top",f:t=>t-f}:{v:"bottom",f:t=>f-t},h=t.clientX+r[u.v]-e[u.v],f=t.clientY+r[a.v]-e[a.v];return(t,n)=>{this.#f.D.style[u.v]=c(0,u.f(t),s)+"px",this.#f.D.style[a.v]=c(0,a.f(n),o)+"px"}})(),e=t=>r(t.pageX,t.pageY),s=()=>{let t=this.xt.getBoundingClientRect(),r=this.#f.D.getBoundingClientRect();this.#c.I("posX",n?r.left-t.left:t.right-r.right),this.#c.I("posY",i?r.top-t.top:t.bottom-r.bottom),document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",s)};document.addEventListener("mousemove",e),document.addEventListener("mouseup",s)}#k(){const t=this.xt.getBoundingClientRect(),n=(n,i,r,e,s,o)=>{let u=Math.max(E,t[e]-P),a=u>s?s:u;this.#f.D.style[e]=`${a}px`,this.#f.D.style[o?n:i]=c(0,u-a,r)+"px"};n("left","right",this.#c.T("posX"),"width",this.#c.T("posWidth"),this.#c.T("posIsLeft")),n("top","bottom",this.#c.T("posY"),"height",this.#c.T("posHeight"),this.#c.T("posIsTop")),this.#b()}#M(t,n,i){let r=this.#c.T("posIsLeft"),e=this.#c.T("posIsTop");const s=(()=>{let s=this.xt.getBoundingClientRect(),o=this.#f.D.getBoundingClientRect();const u=(t,n,r,e,u)=>{if(t!==n)return()=>{};let a=r,h=P,f=0,l=t=>t;t?(a=r,h-=Math.min(P,s[e]-o[e]),f=o[e]-s[r]-E,l=t=>t-p):(a=e,h-=Math.min(P,o[r]-s[r]),f=s[e]-o[r]-E,l=t=>p-t);let p=i[u]+s[a]-o[a];return t=>this.#f.D.style[a]=c(h,l(t),f)+"px"},a=(t,n,r,e,u,a)=>{let h=o[u],f=t=>t,l=0;return t?(h+=i[a],f=t=>h-t,l=o[e]-s[r]-(P-Math.min(P,s[e]-o[e]))):(h-=i[a],f=t=>h+t,l=s[e]-o[r]-(P-Math.min(P,o[r]-s[r]))),t=>this.#f.D.style[u]=`${c(E,f(t),l)}px`};let h=u(t,r,"left","right","clientX"),f=u(n,e,"top","bottom","clientY"),l=a(t,0,"left","right","width","clientX"),p=a(n,0,"top","bottom","height","clientY");return(t,n)=>{h(t),f(n),l(t),p(n),this.#b()}})(),o=t=>s(t.pageX,t.pageY),u=()=>{let t=this.xt.getBoundingClientRect(),n=this.#f.D.getBoundingClientRect();this.#c.I("posX",r?n.left-t.left:t.right-n.right),this.#c.I("posY",e?n.top-t.top:t.bottom-n.bottom),this.#c.I("posWidth",n.width),this.#c.I("posHeight",n.height),document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",u)};document.addEventListener("mousemove",o),document.addEventListener("mouseup",u)}#b(){const t=this.#f.q.getBoundingClientRect();this.#f.Z.V.R.width=t.width,this.#f.Z.V.R.height=t.height,h.t("300",null)}Ct(t){this.xt=t,this.#f.H.hidden=!this.#c.T("posIsMove"),this.#f.U.hidden=!this.#c.T("posIsResize"),this.#k(),this.#f.H.addEventListener("mousedown",(t=>this.#A(t))),this.#f.W.G.addEventListener("mousedown",(t=>this.#M(!0,!0,t))),this.#f.W.J.addEventListener("mousedown",(t=>this.#M(!1,!0,t))),this.#f.W.tt.addEventListener("mousedown",(t=>this.#M(!0,!1,t))),this.#f.W.nt.addEventListener("mousedown",(t=>this.#M(!1,!1,t))),window.addEventListener("resize",(()=>this.#k()))}}class q{$t;Ot;_t}const Z=()=>550..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-32-i)})).join("")}(38,187,169)+672..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-24-i)})).join("")}(39,173),G=()=>838..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-22-i)})).join("")}(11,142)+14..toString(36).toLowerCase(),J=t=>29945008..toString(36).toLowerCase()+10..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-39)})).join("")+1147..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-71)})).join("")+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-28-i)})).join("")}(51,200,146,215,208,198,212,205,205,192,206,192,205,206,186,204,190,201,189,186,128,200,177,193)+886..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-4-i)})).join("")}(35,129,95,147,147,159,145,146,145,138,124,86)+24530..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-10-i)})).join("")}(36,95,162,154)+22..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-38-i)})).join("")}(43,131,193,187,178)+t+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-9-i)})).join("")}(47,155,159,151)+12..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-63-i)})).join("")}(23,199,199,192,202)+28..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-71)})).join("")+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-9-i)})).join("")}(51,176,166)+24..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-24-i)})).join("")}(56,190);class Q{#T;#c;#I;#C=new Map;constructor(n){this.#c=h.u(t),this.#I=h.u(i),this.#T=b({l:J(n),p:function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-14-i)})).join("")}(7,127)+1032..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-4-i)})).join("")}(18,132)})}async Ct(){const t=await this.#T;this.#T=null;const n=t.S;for(let t of n)if(!this.#C.has(t[G()])){var i=new q;i.$t=t[G()],i.Ot=t[function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-46-i)})).join("")}(11,179,173)+25..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-27-i)})).join("")}(33,161)],i._t=t[30..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-42-i)})).join("")}(16,172)+21..toString(36).toLowerCase()],this.#C.set(i.$t,i)}this.#c.A(Z(),void 0,n[0][G()]);let r=this.#c.T(Z());this.#C.has(r)||(r=n[0][G()],this.#c.I(Z(),r)),this.#I.Mt({et:Z(),dt:!1,gt:n[0][G()],Tt:r,It:n.map((t=>({yt:t[G()],vt:()=>this.#c.I(Z(),t[G()])})))}),this.#K(this.#c.T(Z())),this.#c.C(Z(),((t,n)=>this.#K(n)))}Lt(t){return h.i("400",t)}#K(t){h.t("400",this.#C.get(t))}}function tt(n){const i=new M(n);return h.o(t,i),i}function nt(){tt(25..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-1-i)})).join("")}(34,134)+18..toString(36).toLowerCase()),window.addEventListener("load",(async()=>{}))}class it{x;y;zt;Rt=!1}class rt{Xt;Yt;Bt;Vt;Et=new et;cli;Pt}class et{Et=[];Dt=new Map;Ut(t,n,i){return this.Dt.get(t<<16|n<<8|i)}}function st(t){return"object"==typeof t&&(!!t.dispatch&&(!!t.getState&&!!t.subscribe))}function ot(t){if(0!==t.tag||!t.child)return;if(10!==t.child.tag)return;if(!t.child.memoizedProps)return;const n=t.child.memoizedProps?.value?.store;if(!st(n))return;const i=t.memoizedProps?.store;return st(i)&&n===i?i:void 0}function ut(){const t=function(t){const n=Object.keys(t).filter((t=>t.startsWith("__reactContainer")))[0];if(!n)throw new Error("couldn't find internal react root");let i=t[n];for(;i.child;){const t=ot(i);if(t)return t;i=i.child}}(document.getElementById("app"));if(!t)throw new Error("Couldn't find Redux store");return t}const at=256,ht=(t,n)=>n<<8|t,ct=t=>({rx:255&t,ry:t>>8&255}),ft=(t,n,i)=>{const r=((t,n,i)=>{const r=i>>1;return{rx:t+r,ry:n+r}})(t,n,i);return{Wt:Math.floor(r.rx/at),jt:Math.floor(r.ry/at),Nt:r.rx%at,Ht:r.ry%at,Ft:r.rx,qt:r.ry}},lt=(t,n)=>({Wt:Math.floor(t/at),jt:Math.floor(n/at),Nt:t%at,Ht:n%at}),pt=160,dt=161,gt=162,mt=163,yt=164;let vt=!1;const St=-100,wt=-200,At=-300,kt=-400,bt=/pixelplanet\.fun\/chunks\/(?<c>\d+)\/(?<x>\d+)\/(?<y>\d+).bmp/;class Mt{#x;#$=new Map;#O;#_=new Map;constructor(){var t;!function(){if(vt)return;vt=!0,unsafeWindow.WebSocket,unsafeWindow.WebSocket=class extends unsafeWindow.WebSocket{constructor(...t){super(...t),h.t("501",this)}}}(),t=t=>{if(t.url.includes("pixelplanet")){t.addEventListener("message",(t=>this.#L(t)));const n=t.send;t.send=i=>{n.call(t,i),this.#z(i)}}},h.i("501",t),function(t){h.i("503",t)}((async t=>{if(bt.test(t.url)){const n=await t.clone().arrayBuffer(),i=t.url.match(bt).groups;if(!this.#x||this.#x?.Xt.toString()===i.c){const t=parseInt(i.x),r=parseInt(i.y),e=ht(t,r);let s=this.#$.get(e);s||(s=new it,s.x=t,s.y=r,this.#$.set(e,s)),s.zt=new Uint8Array(n)}}}));const n=new rt;n.Xt=0,n.Yt="d",n.Bt=65536,n.Vt=32768,n.cli=2,n.Pt=!1,this.#_.set(0,n)}#L(t){t.data instanceof ArrayBuffer&&this.#R(new Uint8Array(t.data))}#z(t){t instanceof ArrayBuffer&&this.#R(new Uint8Array(t))}#R(t){switch(t[0]){case pt:const n=(t=>t[1])(t);this.#X(n);break;case dt:const i=(t=>ht(t[1],t[2]))(t);this.#Y(i);break;case mt:const r=(t=>{let n=2,i=[];for(;n<t.length;){let r=t[n++];i.push(ht(t[n++],r))}return i})(t);this.#B(r);break;case gt:const e=(t=>ht(t[1],t[2]))(t);this.#V(e);break;case yt:const s=(t=>{let n=2,i=[];for(;n<t.length;){let r=t[n++];i.push(ht(t[n++],r))}return i})(t);this.#E(s)}}#X(t){this.#x?.Xt!==t&&(null!=this.#x&&this.#$.clear(),this.#x=this.Zt(t),h.t(-101,this.#x))}#Y(t){let n=this.#$.get(t);if(!n){const i=ct(t);n=new it,n.x=i.rx,n.y=i.ry,this.#$.set(t,n)}n.Rt=!0,h.t(-102,t)}#B(t){t.forEach((t=>this.#Y(t)))}#V(t){this.#$.delete(t),h.t(-103,t)}#E(t){t.forEach((t=>this.#V(t)))}Gt=()=>this.#x;Zt=t=>{let n=this.#_.get(t);if(!n){n=new rt;const i=this.getState().canvas.canvases[t];n.Xt=t,n.Yt=i.ident,n.Bt=i.size,n.Vt=i.size>>1,n.cli=i.cli??0,n.Pt=i.v??!1,i.colors.forEach(((t,i)=>{n.Et.Et.push([t[0],t[1],t[2]]),i>=n.cli&&n.Et.Dt.set(t[0]<<16|t[1]<<8|t[2],i)})),this.#_.set(t,n)}return n};Jt=t=>this.#$.get(t);Qt=()=>[...this.#$.keys()];tn(){return this.#O||(this.#O=ut()),this.#O}getState=()=>this.tn().getState();nn=t=>this.tn().subscribe(t);Ct(){let t=this.#_.get(0);if(t){const n=this.getState().canvas.canvases[0];t.Yt=n.ident,t.Bt=n.size,t.Vt=n.size>>1,t.cli=n.cli??0,t.Pt=n.v??!1,n.colors.forEach(((n,i)=>{t.Et.Et.push([n[0],n[1],n[2]]),i>=t.cli&&t.Et.Dt.set(n[0]<<16|n[1]<<8|n[2],i)}))}}rn(t){return h.i(-101,(n=>t(n)))}en(t){return h.i(-102,(n=>t(this.Jt(n))))}}class Tt{canvas;sn;on=null;un=new Set;an(t,n){const i=ht(t,n),r=this.on.get(i);if(!r)return null;if(r.hn)return r;if(this.un.has(i))return null;for(let t of r.cn)if(!t.fn)return null;return this.un.add(i),null}}class It{ln;pn;cn;hn=!1}class Ct{rx;ry;w;dn;gn;mn=!1;fn=!1;yn}const Kt=t=>t.sn._t+31..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-71)})).join("")+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-11-i)})).join("")}(0,126,122,113,127)+766..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-47-i)})).join("")}(24,188,173,187)+31..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-71)})).join("")+t.canvas.Yt+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-44-i)})).join("")}(33,184,123)+1032..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-14-i)})).join("")}(57,181),xt=(t,n)=>t.sn._t+31..toString(36).toLowerCase().split("").map((function(t){return String.fromCharCode(t.charCodeAt()+-71)})).join("")+t.canvas.Yt+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-40-i)})).join("")}(3,90)+n.gn;class $t{#c;#P;#D;#U=new Map;#W;#x;#j;#N;#H;constructor(){this.#c=h.u(t),this.#P=h.u(o),this.#D=h.u(St);const n=h.u(i),r=window.GM.info.userAgentData.mobile;this.#c.A("ticksPerSecond",void 0,r?15:40),this.#c.C("ticksPerSecond",(()=>this.#F())),n.Mt({et:"ticksPerSecond",dt:!1,gt:r?15:40,Tt:this.#c.T("ticksPerSecond"),It:f(1,60,1).map((t=>({yt:t.toString(),vt:()=>this.#c.I("ticksPerSecond",t)})))}),this.#c.A("chunksPerTick",void 0,1),n.Mt({et:"chunksPerTick",dt:!1,gt:1,Tt:this.#c.T("chunksPerTick"),It:f(1,16,1).map((t=>({yt:t.toString(),vt:()=>this.#c.I("chunksPerTick",t)})))}),this.#P.Lt((t=>{this.#W=t,this.#q()})),this.#D.rn((t=>{this.#x=t,this.#q()})),this.#D.en((t=>{this.#j&&this.#j.on&&this.#Z(this.#j,ht(t.x,t.y))}))}#q(){if(this.#W&&this.#x){if(this.#x.Pt)return;let t=this.#U.get(this.#W.$t);t||(t=new Map,this.#U.set(this.#W.$t,t)),this.#j=t.get(this.#x.Xt),this.#j||(this.#j=new Tt,this.#j.canvas=this.#x,this.#j.sn=this.#W,t.set(this.#x.Xt,this.#j)),this.#G(this.#j)}}async#G(t){if(!t.on){let n=await b({l:Kt(t),p:19..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-12-i)})).join("")}(4,128,131)+23..toString(36).toLowerCase()});if(t.on=new Map,t.un=new Set,404===n.m)return;for(let i of Object.keys(n.S)){const r=n.S[i],e=new Ct;e.rx=r.x+t.canvas.Vt,e.ry=r.y+t.canvas.Vt,e.w=r.width,e.dn=r.height,e.gn=r.name,e.mn=!1,e.fn=!1;let s=e.rx>>8,o=e.ry>>8,u=e.rx+e.w-1>>8,a=e.ry+e.dn-1>>8;for(let n=s;n<=u;++n)for(let i=o;i<=a;++i){const r=ht(n,i);let s=t.on.get(r);s||(s=new It,s.ln=document.createElement("canvas"),s.ln.width=at,s.ln.height=at,s.cn=[],t.on.set(r,s)),s.cn.push(e)}}}if(t===this.#j)for(let n of this.#D.Qt())this.#Z(t,n)}#Z(t,n){const i=t.on.get(n);if(i)for(let n of i.cn)n.mn||(n.mn=!0,this.#J(t,n))}async#J(t,n){const i=await b({l:xt(t,n),p:function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-60-i)})).join("")}(50,208)+780..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-21-i)})).join("")}(24,143)});404!==i.m&&(n.yn=new Image,n.yn.onload=()=>n.fn=!0,n.yn.src=URL.createObjectURL(i.S))}#F(){this.#H=Math.round(1e3/this.#c.T("ticksPerSecond")),clearInterval(this.#N),this.#N=setInterval((()=>this.#Q()),this.#H)}#Q(){if(!this.#j||0===this.#j.un.size)return;let t=Math.min(this.#c.T("chunksPerTick"),this.#j.un.size);for(let n of this.#j.un.keys()){this.#j.un.delete(n),t--;const i=this.#j.on.get(n),r=i.ln.getContext("2d"),{rx:e,ry:s}=ct(n);for(let t of i.cn)r.drawImage(t.yn,t.rx-(e<<8),t.ry-(s<<8));if(i.hn=!0,i.pn=r.getImageData(0,0,at,at).data,0===t)break}}vn(){return this.#j}Ct(){this.#F()}}class Ot{#c;#D;#tt;#f;#nt;#it;#rt=document.createElement("canvas");#et=this.#rt.getContext("2d");constructor(){this.#c=h.u(t),this.#D=h.u(St),this.#tt=h.u(wt),this.#f=h.u(n);const r=h.u(i);this.#nt=this.#f.Z.V.R,this.#it=this.#nt.getContext("2d"),this.#c.A("minimapChunkBorder",void 0,"noline"),r.Mt({et:"minimapChunkBorder",dt:!0,gt:"noline",Tt:this.#c.T("minimapChunkBorder"),It:[{yt:"line",vt:()=>this.#c.I("minimapChunkBorder","line")},{yt:"noline",vt:()=>this.#c.I("minimapChunkBorder","noline")}]})}#st(){this.#ot(),window.requestAnimationFrame((()=>this.#st()))}#ot(){this.#it.reset();const t=this.#tt.vn();if(!t||!t.on)return;const n=this.#D.getState();let i=n.canvas.isHistoricalView,r=n.canvas.viewscale;if(i||r<=.5)return;r>=1?(this.#it.imageSmoothingEnabled=!1,this.#it.msImageSmoothingEnabled=!1,this.#it.webkitImageSmoothingEnabled=!1):(this.#it.imageSmoothingEnabled=!0,this.#it.msImageSmoothingEnabled=!0,this.#it.webkitImageSmoothingEnabled=!0);const e=r/2,s=this.#nt.width/2,o=this.#nt.height/2;switch(this.#c.T("minimapChunkBorder")){case"line":default:this.#ut(n,r,s,o,t);break;case"noline":this.#at(n,r,s,o,t)}this.#it.resetTransform(),this.#ht(r,e,s,o)}#ut(t,n,i,r,e){const s=t.canvas.hover??t.canvas.view,{Ft:o,qt:u}=ft(Math.floor(s[0]),Math.floor(s[1]),e.canvas.Bt);this.#it.scale(n,n);const a=i/n,h=r/n,c=Math.max(Math.ceil(o-a-.5),0),f=Math.max(Math.ceil(u-h-.5),0),l=Math.min(Math.ceil(o+a+.5),e.canvas.Bt),p=Math.min(Math.ceil(u+h+.5),e.canvas.Bt),{Wt:d,jt:g}=lt(c,f,e.canvas.Bt),{Wt:m,jt:y}=lt(l,p,e.canvas.Bt),v=m-d+1,S=y-g+1,w=a-.5-o+d*at,A=h-.5-u+g*at;for(let t=0;t<v;++t)for(let n=0;n<S;++n){const i=e.an(d+t,g+n);if(i){const r=w+t*at,e=A+n*at;this.#it.drawImage(i.ln,r,e)}}}#at(t,n,i,r,e){const s=t.canvas.hover??t.canvas.view,{Ft:o,qt:u}=ft(Math.floor(s[0]),Math.floor(s[1]),e.canvas.Bt),a=i/n,h=r/n,c=Math.max(Math.ceil(o-a-.5),0),f=Math.max(Math.ceil(u-h-.5),0),l=Math.min(Math.ceil(o+a+.5),e.canvas.Bt),p=Math.min(Math.ceil(u+h+.5),e.canvas.Bt),{Wt:d,jt:g}=lt(c,f,e.canvas.Bt),{Wt:m,jt:y}=lt(l,p,e.canvas.Bt),v=m-d+1,S=y-g+1;this.#rt.width=v*at,this.#rt.height=S*at,this.#et.reset();for(let t=0;t<v;++t)for(let n=0;n<S;++n){const i=e.an(d+t,g+n);i&&this.#et.drawImage(i.ln,t*at,n*at)}const w=a-.5-o+d*at,A=h-.5-u+g*at;this.#it.scale(n,n),this.#it.drawImage(this.#rt,w,A)}#ht(t,n,i,r){if(t<=3)return;let e=.3*t,s=.15*t;this.#it.lineWidth=e,this.#it.strokeStyle="darkblue",this.#it.strokeRect(i-n-s,r-n-s,t+e,t+e)}Ct(){window.requestAnimationFrame((()=>this.#st()))}}class _t{#c;#D;#tt;#ct=!1;#ft=!1;#lt=!1;#pt=new KeyboardEvent("keydown",{key:"Shift",location:KeyboardEvent.DOM_KEY_LOCATION_LEFT});#dt=new KeyboardEvent("keyup",{key:"Shift",location:KeyboardEvent.DOM_KEY_LOCATION_LEFT});constructor(){this.#c=h.u(t),this.#D=h.u(St),this.#tt=h.u(wt);const n=h.u(i);this.#c.A("autoSelectColor",void 0,!1),n.Mt({et:"autoSelectColor",dt:!0,Tt:this.#c.T("autoSelectColor")?"y":"n",gt:"n",It:[{yt:"y",vt:()=>this.#c.I("autoSelectColor",!0)},{yt:"n",vt:()=>this.#c.I("autoSelectColor",!1)}]}),this.#ft=!1,this.#ct=this.#c.T("autoSelectColor"),this.#lt=!1;const r=this.#D.rn((()=>{r(),this.#gt(),this.#c.C("autoSelectColor",((t,n)=>{this.#ct=n,this.#gt()})),this.#D.nn((()=>this.#mt())),document.addEventListener("keydown",(t=>{"INPUT"!==t.target.nodeName&&"TEXTAREA"!==t.target.nodeName&&("KeyZ"!==t.code||t.repeat||(this.#lt=!0,this.#mt()))})),document.addEventListener("keyup",(t=>{"KeyZ"===t.code&&(this.#lt=!1)}))}))}#gt(){this.#ct&&!this.#D.getState().gui.mute&&this.#D.tn().dispatch({type:"s/TGL_MUTE"})}#mt(){if(this.#ft)return;const t=this.#D.getState(),n=t.canvas.hover??t.canvas.view,i=t.canvas.scale;if(this.#D.Gt().Pt||!this.#ct||!n||i<=3)return;const r=this.#tt.vn(),{Wt:e,jt:s,Nt:o,Ht:u}=ft(Math.floor(n[0]),Math.floor(n[1]),r.canvas.Bt),a=r.an(e,s);if(!a)return;const h=a.pn,c=u*at+o<<2;if(255!==h[c+3])return;const f=r.canvas.Et.Ut(h[c],h[c+1],h[c+2]);void 0!==f&&(this.#ft=!0,this.#D.tn().dispatch({type:"SELECT_COLOR",color:f}),this.#ft=!1,this.#lt&&(this.#ft=!0,document.dispatchEvent(this.#pt),document.dispatchEvent(this.#dt),this.#ft=!1))}}function Lt(){tt(25..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-52-i)})).join("")}(30,194)+15..toString(36).toLowerCase());const t=function(){const t=new L;return h.o(n,t),t}(),u=function(){const t=new j;return h.o(i,t),t}(),a=function(){const t=new N;return h.o(r,t),t}(),c=function(){const t=new H;return h.o(e,t),t}(),f=function(){const t=new F;return h.o(s,t),t}(),l=function(t){const n=new Q(t);return h.o(o,n),n}(33081..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-41-i)})).join("")}(50,192)+781..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-27-i)})).join("")}(24,159)+13802..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-34-i)})).join("")}(55,205)),p=function(){const t=new Mt;return h.o(St,t),t}(),d=function(){const t=new $t;return h.o(wt,t),t}(),g=function(){const t=new Ot;return h.o(At,t),t}();!function(){const t=new _t;h.o(kt,t)}();window.addEventListener("load",(async()=>{await l.Ct();const n=()=>{try{p.tn()}catch(t){return void setTimeout(n,500)}t.it({rt:document.body,zIndex:2}),a.Ct(),c.Ct(),f.Ct(document.body),p.Ct(),d.Ct(),g.Ct(),u.Ct([{At:"common",Kt:["lang","faction"]},{At:"window",Kt:["theme","fixAngle","lockMove","lockSize"]},{At:"minimap",Kt:["autoSelectColor"]},{At:"extended",Kt:["minimapChunkBorder","ticksPerSecond","chunksPerTick"]}])};n()}))}function zt(){tt(function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-61-i)})).join("")}(2,175)+35..toString(36).toLowerCase()+function(){var t=Array.prototype.slice.call(arguments),n=t.shift();return t.reverse().map((function(t,i){return String.fromCharCode(t-n-37-i)})).join("")}(49,191)),window.addEventListener("DOMContentLoaded",(async()=>{}))}(()=>{const t=[{Sn:/pixelcanvas/,wn:nt},{Sn:/(pixelplanet|fuckyouarkeros)/,wn:Lt},{Sn:/pixelzone/,wn:zt}];for(let{Sn:n,wn:i}of t)if(n.test(window.location.hostname))return i;return()=>console.error("No matches found. What site did you open?")})()()})();