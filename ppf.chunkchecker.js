(()=>{const n=.2;const t=256,e=768;function l(n,t,e,l,r){n&&(n.some((n=>n))||postMessage([!1,null,null,null,null,null])),postMessage([!0,n,t,e,l,r])}self.onmessage=r=>{const o=r.data;let u;switch(o[0]){case 1:u=function*(n,t,e){const l=new Map;t.forEach((([n,t,r],o)=>{o>=e&&l.set(n<<16|t<<8|r,o)}));const r=(n,r,o,u)=>{if(u<128)return null;const s=n<<16|r<<8|o;let i=l.get(s);return void 0===i&&(i=t.map((([t,l,u],s)=>{if(s<e)return;return[Math.sqrt((n-t)**2+(r-l)**2+(o-u)**2),s]})).filter((n=>n)).sort(((n,t)=>n[0]-t[0]))[0][1],l.set(s,i),console.log([n,r,o,u],"  --\x3e ",i,t[i])),i};for(let t=0;t<65536;++t){let e=t<<2;const l=r(n[e++],n[e++],n[e++],n[e]);yield[t,l]}}(o[2],o[5],o[6]);break;case 2:u=function*(n,t){for(let e=0;e<=n.length;++e)yield[e,n[e]?t[e]:null]}(o[2],o[3]);break;default:u=null}u||l(null,null,null,null,null);const s=2!==o[0]&&1&o[1]?function(n){const t=new Array(65536),e=new Uint8ClampedArray(t.length),l=new Uint8ClampedArray(t.length<<2);return{action:(r,o)=>{let u=r<<2;if(Number.isInteger(o)){t[r]=!0,e[r]=o;const[s,i,c]=n[o];return l[u++]=s,l[u++]=i,l[u++]=c,void(l[u]=255)}t[r]=!1,e[r]=0,l[u++]=0,l[u++]=0,l[u++]=0,l[u]=0},t,l:e,o:l}}(o[5]):null,i=2&o[1]?function(t,e,l){const r=new Uint8ClampedArray(262144),o=e.map((([n,t,r],o)=>{if(o<l){let o=e.slice(l).map(((n,t)=>[n,t])).filter((([[e,l,o]])=>n===e&&t===l&&r===o))[0];if(o)return o[1]+l}return o}));return{action:(l,u)=>{let[s,i,c,a]=[0,0,0,0];Number.isInteger(u)&&([s,i,c]=o[127&t[l]]===u?function([t,e,l]){return[t*n,e*n,l*n]}(e[u]):(e[u],[255,0,0]),a=255);let f=l<<2;r[f++]=s,r[f++]=i,r[f++]=c,r[f]=a},u:r}}(o[4],o[5],o[6]):null,c=4&o[1]?function(n){const l=new Uint8ClampedArray(2359296),r=n=>{const[l,r]=((n,t=256)=>[n%t,Math.floor(n/t)%t])(n,t);return(([n,t],e=256)=>t*e+n)([3*l+1,3*r+1],e)};return{action:(t,e)=>{let o=r(t)<<2;if(Number.isInteger(e)){const[t,r,u]=n[e];return l[o++]=t,l[o++]=r,l[o++]=u,void(l[o]=255)}l[o++]=0,l[o++]=0,l[o++]=0,l[o]=0},i:l}}(o[5]):null;for(let[n,t]of u)s?.action(n,t),i?.action(n,t),c?.action(n,t);l(s?.t,s?.l,s?.o,i?.u,c?.i)}})();