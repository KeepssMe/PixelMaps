(()=>{const n=.2;const t=256,l=768;function e(n,t,l,e,r){n&&(n.some((n=>n))||postMessage([!1,null,null,null,null,null])),postMessage([!0,n,t,l,e,r])}self.onmessage=r=>{const o=r.data;let u;switch(o[0]){case 1:u=function*(n,t,l){const e=new Map;t.forEach((([n,t,r],o)=>{o>=l&&e.set(n<<16|t<<8|r,o)})),console.log(t);const r=(n,r,o,u)=>{if(u<128)return null;const s=n<<16|r<<8|o;let c=e.get(s);return void 0===c&&(c=t.map((([t,e,u],s)=>{if(s<l)return;return[Math.sqrt((n-t)**2+(r-e)**2+(o-u)**2),s]})).filter((n=>n)).sort(((n,t)=>n[0]-t[0]))[0][1],e.set(s,c),console.log([n,r,o,u],"  --\x3e ",c,t[c])),c};for(let t=0;t<65536;++t){let l=t<<2;const e=r(n[l++],n[l++],n[l++],n[l]);yield[t,e]}}(o[2],o[5],o[6]);break;case 2:u=function*(n,t){for(let l=0;l<=n.length;++l)yield[l,n[l]?t[l]:null]}(o[2],o[3]);break;default:u=null}u||e(null,null,null,null,null);const s=2!==o[0]&&1&o[1]?function(n){const t=new Array(65536),l=new Uint8ClampedArray(t.length),e=new Uint8ClampedArray(t.length<<2);return{action:(r,o)=>{let u=r<<2;if(o){t[r]=!0,l[r]=o;const[s,c,i]=n[o];return e[u++]=s,e[u++]=c,e[u++]=i,void(e[u]=255)}t[r]=!1,l[r]=0,e[u++]=0,e[u++]=0,e[u++]=0,e[u]=0},t,l,o:e}}(o[5]):null,c=2&o[1]?function(t,l,e){const r=new Uint8ClampedArray(262144),o=l.map((([n,t,r],o)=>{if(o<e){let o=l.slice(e).map(((n,t)=>[n,t])).filter((([[l,e,o]])=>n===l&&t===e&&r===o))[0];if(o)return o[1]+e}return o}));return{action:(e,u)=>{let[s,c,i,a]=[0,0,0,0];u&&([s,c,i]=o[127&t[e]]===u?function([t,l,e]){return[t*n,l*n,e*n]}(l[u]):(l[u],[255,0,0]),a=255);let f=e<<2;r[f++]=s,r[f++]=c,r[f++]=i,r[f]=a},u:r}}(o[4],o[5],o[6]):null,i=4&o[1]?function(n){const e=new Uint8ClampedArray(2359296),r=n=>{const[e,r]=((n,t=256)=>[n%t,Math.floor(n/t)%t])(n,t);return(([n,t],l=256)=>t*l+n)([3*e+1,3*r+1],l)};return{action:(t,l)=>{let o=r(t)<<2;if(l){const[t,r,u]=n[l];return e[o++]=t,e[o++]=r,e[o++]=u,void(e[o]=255)}e[o++]=0,e[o++]=0,e[o++]=0,e[o]=0},i:e}}(o[5]):null;for(let[n,t]of u)s?.action(n,t),c?.action(n,t),i?.action(n,t);e(s?.t,s?.l,s?.o,c?.u,i?.i)}})();